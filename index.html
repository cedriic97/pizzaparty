<!doctype html>
<html>
    <head>
        <meta charset="utf8">

        <style>
            body {
                height: 100vh;
                display: flex;
                flex-direction: column;
            }

            iframe {
                margin: auto;
                width: 80vw;
                height: 80vh;
            }
        </style>
    </head>

    <body>
        <button>POST MESSAGE</button>

        <iframe src="http://localhost:4200"></iframe>

        <script>
            users = "";
            var postObject
            function loadJSON(callback) {   
                var xobj = new XMLHttpRequest();
                xobj.overrideMimeType("application/json");
                xobj.open('GET', '../src/assets/hype-data/users.json', true); // Replace 'my_data' with the path to your file
                xobj.onreadystatechange = function () {
                    if (xobj.readyState == 4 && xobj.status == "200") {
                        // Required use of an anonymous callback as .open will NOT return a value but simply returns undefined in asynchronous mode
                        callback(xobj.responseText);
                    }
                };
                xobj.send(null);  
            }
           
            loadJSON(function(text){
                var data = JSON.parse(text);
                postObject = data;
            });

            const iframe = document.querySelector('iframe');
            const button = document.querySelector('button');
            
            function post(msg) {
                iframe.contentWindow.postMessage(postObject, '*');
            }

            window.addEventListener('message', function(e) {
                post(e.data)
            }, false);

            button.addEventListener('click', post);
        </script>
    </body>
</html>